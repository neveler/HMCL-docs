kind: pipeline
type: docker
name: default

clone:
  depth: 1

steps:
- name: build
  image: jekyll/jekyll:4.2.2
  environment:
    JEKYLL_ENV: production
  commands:
    - bash scripts/build.sh
  volumes:
  - name: dist
    path: /drone/src/_site
  - name: cache
    path: /drone/src/.jekyll-cache
  when:
    branch: [main]

volumes:
- name: dist
  host:
    path: /home/ubuntu/docs.hmcl.net/www
- name: cache
  host:
    path: /home/ubuntu/docs.hmcl.net/cache
